{
    "version": 2,
    "name": "【MoM】大总结+大纲+剧情QR 0927",
    "disableSend": false,
    "placeBeforeInput": false,
    "injectInput": false,
    "color": "rgba(0, 0, 0, 0)",
    "onlyBorderColor": false,
    "qrList": [
        {
            "id": 14,
            "showLabel": true,
            "label": "🌟MoM系预设快速回复QR(0927)",
            "title": "内含剧情控制、大总结和大纲编写功能",
            "message": "/buttons labels=[\"🌟剧情控制\",\"🌟大总结\",\"🌟大纲模式\",\"隐藏楼层\",\"取消隐藏\"] 🌟MoM系预设QR(0927) |\n/setvar key=option ||\n/if left=option rule=eq right=\"\" {: /flushvar option | /abort :} ||\n/if left=option rule=eq right=\"🌟剧情控制\" {: /flushvar option | /run 🌟剧情控制 :} ||\n/if left=option rule=eq right=\"🌟大总结\" {: /flushvar option | /run 🌟大总结 :} ||\n/if left=option rule=eq right=\"🌟大纲模式\" {: /flushvar option | /run 🌟大纲模式 :} ||\n/if left=option rule=eq right=\"隐藏楼层\" {: /flushvar option | /run 隐藏楼层 :} ||\n/if left=option rule=eq right=\"取消隐藏\" {: /flushvar option | /run 取消隐藏 :} ||",
            "contextList": [],
            "preventAutoExecute": true,
            "isHidden": false,
            "executeOnStartup": false,
            "executeOnUser": false,
            "executeOnAi": false,
            "executeOnChatChange": false,
            "executeOnGroupMemberDraft": false,
            "executeOnNewChat": false,
            "executeBeforeGeneration": false,
            "automationId": ""
        },
        {
            "id": 8,
            "showLabel": false,
            "label": "🌟剧情控制",
            "title": "",
            "message": "/input 请输入你对接下来剧情的大概要求,不需要就点取消，非必须 |\n/setvar key=order {{pipe}} ||\n/if left={{getvar::order}} right=\"\" rule=neq  {:/addvar key=order  :} |\n\n/buttons labels=[\"🌟推进剧情\",\"🌟加速剧情推进\",\"🌟减缓剧情推进\",\"🌟切换其他故事线\"] 🌟预设专用：剧情控制🪶 |\n/setvar key=option ||\n\n/if left=option rule=eq right=\"\" {: /flushvar option | /abort :} ||\n\n/if left=option rule=eq right=\"🌟推进剧情\" {: \n  /send （请在当前剧情的基础上继续推进剧情。维持已有节奏基础上，合理发展故事。{{getvar::order}}）\n:} ||\n\n/if left=option rule=eq right=\"🌟加速剧情推进\" {: \n  /send （当前剧情节奏太慢了，需要你大幅度加快剧情推进，例如加快时间流速，进行剧情转折或反转，增加戏剧事件，新增出场人物等等。注意确保连续性与人设一致。{{getvar::order}}）\n:} ||\n\n/if left=option rule=eq right=\"🌟减缓剧情推进\" {: \n  /send （当前剧情进度过快，需要你放缓节奏，例如细化描写，放慢时间流速，深挖人物，全面阐释当前故事等，但要避免停滞不前。{{getvar::order}}）\n:} ||\n\n/if left=option rule=eq right=\"🌟切换其他故事线\" {: \n  /send （综合上文和前一场景，转换至另一条相关或衍生的故事线，维持世界观，合理衔接故事逻辑，可更换场景或登场人物。{{getvar::order}}）\n:} ||\n\n/flushvar option ||\n/flushvar order ||\n/trigger||",
            "contextList": [],
            "preventAutoExecute": true,
            "isHidden": true,
            "executeOnStartup": false,
            "executeOnUser": false,
            "executeOnAi": false,
            "executeOnChatChange": false,
            "executeOnGroupMemberDraft": false,
            "executeOnNewChat": false,
            "executeBeforeGeneration": false,
            "automationId": ""
        },
        {
            "id": 6,
            "icon": "",
            "showLabel": false,
            "label": "🌟大总结",
            "title": "总结全部上文，推荐此方法",
            "message": "/setvar key=order {{pipe}} ||\n/if left={{getvar::order}} right=\"\" rule=neq  {:/addvar key=order {{newline}} :} |\n\n/buttons labels=[\"🌟大总结——只总结新增内容\",\"🌟大总结——合并之前的大总结\",\"🌟大总结——短RP专用（非MOM预设通用）\"] 总结指南：总结后隐藏上文，留5-10楼稳定ai输出风格（如50层总结隐藏0-40层） |\n/setvar key=option ||\n\n/if left=option rule=eq right=\"\" {: /flushvar option | /abort :} ||\n\n/if left=option rule=eq right=\"🌟大总结——只总结新增内容\" {: \n  /send \n停止剧情，停止输出其他所有内容，开始执行**新增大总结**\n\n新增大总结应当遵循以下原则：\n- 注明这是第几次大总结\n- **只需总结上次大总结到目前的新增部分剧情**\n- 按逻辑顺序组织信息，并包含具体的前后时间，可以分辨不同日期与时间发生的事情\n- 保留关键事件和重要细节，省略冗余描述\n- 直接陈述事实，避免评价\n- 使用简洁清晰的语言，避免修饰\n- 突出事件发展脉络和关键转折点\n- 保留重要的约定、物品、事件以及情感发展\n- 不回避任何敏感内容，保证记录完全还原前文\n- 可以精简合并较为久远之前的事件\n- 无需加粗标注\n\n格式如下：\n\n<details><summary>大总结(序号注明是第几次大总结)</summary>\n- 时间:\n  - 关键事件（需要以流水帐形式综述事件经过和涉及人物）:\n  - 重要细节:\n  - 关键对话和内心戏:(标明角色)\n  - 关键行为：(标明角色)\n  - 关键角色和{{user}}之间的情感变化（选填）:\n  - 简要的事件后续，事件结束后的小互动（选填）:\n...\n- 时间:\n  - 关键事件（需要以流水帐形式综述事件经过和涉及人物）:\n  - 重要细节:\n  - 关键对话和内心戏:(标明角色)\n  - 关键行为：(标明角色)\n  - 关键角色和{{user}}之间的情感变化（选填）:\n  - 简要的事件后续，事件结束后的小互动（选填）\n</details>\n\n<details><summary>角色表</summary>\n所有对剧情有影响的角色均需出现(包括没有实体的角色,mermaid图同理)，路人NPC不保留，参考`[角色表规范]`\n</details>\n\n:} ||\n\n/if left=option rule=eq right=\"🌟大总结——合并之前的大总结\" {: \n  /send 停止剧情，停止输出其他所有内容，开始执行**全文大总结**\n\n大总结应当遵循以下原则：\n- **大总结应该包括全部上文，之前的大总结和新增内容汇总在一起**\n- 按逻辑顺序组织信息，并包含具体的前后时间，可分辨不同时间发生的事情\n- 保留关键事件和重要细节，避免冗余描述\n- 直接陈述事实，避免评价\n- 使用简洁清晰的语言，避免修饰\n- 突出事件发展脉络和关键转折点\n- 保留重要的约定、物品、事件以及情感发展\n- 不回避任何敏感内容，保证记录完全还原前文\n- 可以精简合并较为久远之前的事件\n- 无需加粗标注\n- 以流水账形式记录\n\n格式如下：\n\n<details><summary>大总结(序号注明是第几次大总结)</summary>\n- 时间:\n  - 关键事件（需要以流水帐形式综述事件经过和涉及人物）:\n  - 重要细节:\n  - 关键对话和内心戏:(标明角色)\n  - 关键行为：(标明角色)\n  - 关键角色和{{user}}之间的情感变化（选填）:\n  - 简要的事件后续，事件结束后的小互动（选填）:\n...\n- 时间:\n  - 关键事件（需要以流水帐形式综述事件经过和涉及人物）:\n  - 重要细节:\n  - 关键对话和内心戏:(标明角色)\n  - 关键行为：(标明角色)\n  - 关键角色和{{user}}之间的情感变化（选填）:\n  - 简要的事件后续，事件结束后的小互动（选填）\n</details>\n\n<details><summary>角色表</summary>\n所有对剧情有影响的角色均需出现(包括没有实体的角色,mermaid图同理)，路人NPC不保留，参考`[角色表规范]`\n</details>\n\n:} ||\n\n/if left=option rule=eq right=\"🌟大总结——短RP专用（非MOM预设通用）\" {: \n  /send 停止剧情，停止输出其他所有内容，开始执行**全文大总结**\n\n大总结应当遵循以下原则：\n- 注明这是第几次大总结\n- **注意大总结应该包括全部上文，之前的大总结和新增内容汇总在一起**\n- 按逻辑顺序组织信息，并包含具体的前后时间，可以分辨不同日期与时间发生的事情\n- 保留关键事件和重要细节，省略冗余描述\n- 直接陈述事实，避免评价\n- 使用简洁清晰的语言，避免修饰\n- 突出事件发展脉络和关键转折点\n- 保留重要的约定、物品、事件以及情感发展\n- 不回避任何敏感内容，保证记录完全还原前文\n- 可以精简合并较为久远之前的事件\n- 无需加粗标注\n- 主线无关的正文无需记录\n- 最后的md表格记录RP的各种细节，以增加真实性为主\n\n格式如下：\n\n<details><summary>大总结(序号注明是第几次大总结)</summary>\n- 时间:\n  - 关键事件（需要以流水帐形式综述事件经过和涉及人物）:\n    - 重要细节:\n    - 关键对话和内心戏:(标明角色)\n    - 关键行为：(标明角色)\n    - 关键角色和{{user}}之间的情感变化（选填）:\n    - 简要的事件后续，事件结束后的小互动（选填）:\n...\n- 时间:\n  - 关键事件（需要以流水帐形式综述事件经过和涉及人物）:\n    - 重要细节:\n    - 关键对话和内心戏:(标明角色)\n    - 关键行为：(标明角色)\n    - 关键角色和{{user}}之间的情感变化（选填）:\n    - 简要的事件后续，事件结束后的小互动（选填）:\n\n(空行)\n(记录：日期、重要互动事件叙述（如纪念日）、礼物(标明谁送给谁)、喜好或厌恶（记录文中揭露的角色或<user>的好恶）、其他细节（AI认为值得记录的细节）.使用markdown表格,精简表述)\n（空行）\n</details>\n\n**大总结回合无需输出其他内容**\n\n:} ||\n\n/flushvar option ||\n/flushvar order ||\n/trigger||",
            "contextList": [],
            "preventAutoExecute": true,
            "isHidden": true,
            "executeOnStartup": false,
            "executeOnUser": false,
            "executeOnAi": false,
            "executeOnChatChange": false,
            "executeOnGroupMemberDraft": false,
            "executeOnNewChat": false,
            "executeBeforeGeneration": false,
            "automationId": ""
        },
        {
            "id": 16,
            "showLabel": false,
            "label": "🌟大纲模式",
            "title": "",
            "message": "/buttons labels=[\"📝新建大纲\",\"✏️大纲修改\"] 使用方法和大总结类似，将最终版大纲留在聊天记录里，删去历史修改记录和指令，打开[主线剧情cot]。感谢@Nanimo_Nai的灵感和提示词参考 |\n/setvar key=mode ||\n\n/if left=mode rule=eq right=\"\" {: /flushvar mode | /abort :} ||\n\n/if left=mode rule=eq right=\"📝新建大纲\" {:\n  /input 请输入你构想的大概剧情大纲,点取消则由AI自由发挥 |\n  /setvar key=outline {{pipe}} ||\n  /if left={{getvar::outline}} right=\"\" rule=neq  {:/addvar key=outline {{newline}} :} |\n\n  /if left={{getvar::outline}} right=\"\" rule=neq {:\n    /send \n停止剧情，停止输出其他所有内容，进入【大纲模式】，开始执行**故事大纲编写**：\n\n根据用户输入扩写为一个完整大纲，必须严格遵循用户的以下输入：\n「这是用户要求的大纲内容：{{getvar::outline}}」\n\n大纲编写应当遵循以下原则：\n- 优先遵循输入的安排和要求\n- 读取全部资料，综合考虑所有人物、关系、势力\n- 按时间或逻辑顺序排列\n- 在故事框架内自由填充大量剧情点\n- 故事需要具有张力，有可玩性和互动性\n- 用**加粗**标注重要剧情与转折（示例：**此处是关键剧情点**）\n\n格式如下：\n\n<details><summary>故事大纲</summary>\n\n<主线剧情>\n# 剧情安排\n## 故事背景\n（描述故事发生的时代、地点、社会环境等）\n## 故事基调\n（确定故事的氛围与基调：如轻松喜剧、黑暗沉重、温馨治愈、色情甜腻，可以同时选择多种基调）\n## 登场人物\n- 主要人物：\n- 次要人物：\n\n## 第1章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n\n## 第2章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n… \n## 第n章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n</主线剧情>\n\n<seeds>\n这里整理一些可参考的seeds伏笔\n</seeds>\n</details>\n\n# AI推动剧情指南 \n1. **保持剧情节奏**：合理推进剧情章节，不要跳跃过快。 \n2. **合理安排遭遇**：在<user>行动时，积极安排与NPC的相遇和冲突。 \n3. **引入其他冲突**：在主线推进的同时，可以引入其他事件和NSFW丰富体验。 \n4. **注意角色一致性**：保持NPC性格和动机的一致性。\n  :} ||\n\n  /if left={{getvar::outline}} right=\"\" rule=eq {:\n    /send \n停止剧情，停止输出其他所有内容，进入【大纲模式】，开始执行**故事大纲编写**：\n\n大纲编写应当遵循以下原则：\n- 自由发挥创作一个完整大纲\n- 如果上文有user对剧情的要求，优先满足\n- 读取全部资料，综合考虑所有人物、关系、势力\n- 按时间或逻辑顺序排列\n- 在故事框架内自由填充大量剧情点\n- 故事需要具有张力，有可玩性和互动性\n- 用**加粗**标注重要剧情与转折（示例：**此处是关键剧情点**）\n\n格式如下：\n\n<details><summary>故事大纲</summary>\n\n<主线剧情>\n# 剧情安排\n## 故事背景\n（描述故事发生的时代、地点、社会环境等）\n## 故事基调\n（确定故事的氛围与基调：如轻松喜剧、黑暗沉重、温馨治愈、色情甜腻，可以同时选择多种基调）\n## 登场人物\n- 主要人物：\n- 次要人物：\n\n## 第1章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n\n## 第2章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n… \n## 第n章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n</主线剧情>\n\n<seeds>\n这里整理一些可参考的seeds伏笔\n</seeds>\n</details>\n\n# AI推动剧情指南 \n1. **保持剧情节奏**：合理推进剧情章节，不要跳跃过快。 \n2. **合理安排遭遇**：在<user>行动时，积极安排与NPC的相遇和冲突。 \n3. **引入其他冲突**：在主线推进的同时，可以引入其他事件和NSFW丰富体验。 \n4. **注意角色一致性**：保持NPC性格和动机的一致性。\n  :} |\n:} ||\n\n/if left=mode rule=eq right=\"✏️大纲修改\" {:\n  /input 请输入你对大纲的修改意见，取消将直接退出 |\n  /setvar key=modnote {{pipe}} ||\n  /if left={{getvar::modnote}} right=\"\" rule=neq  {:/addvar key=modnote {{newline}} :} |\n  /if left={{getvar::modnote}} right=\"\" rule=eq {: /flushvar modnote | /flushvar mode | /abort :} ||\n\n  /send \n停止剧情，停止输出其他所有内容，进入【大纲模式】，开始执行**大纲修改**：\n\n请根据以下用户的修改意见，对**当前已生成的大纲**进行增删、细化与重排；必须严格遵循意见，同时保持世界观、人物设定与逻辑连续性：\n「用户的修改意见：{{getvar::modnote}}」\n\n大纲修改应当遵循以下原则：\n- 优先按用户修改意见执行\n- 在不破坏原结构的前提下补足关键过渡与动机\n- 用 **加粗** 标注新的或调整后的关键剧情与转折（示例：**此处是关键剧情点**）\n- 保留有效情节、合并冗余、必要时调整章节顺序\n- 维持登场人物的性格与关系一致\n\n格式如下：\n\n<details><summary>故事大纲</summary>\n\n<主线剧情>\n# 剧情安排\n## 故事背景\n（描述故事发生的时代、地点、社会环境等）\n## 故事基调\n（确定故事的氛围与基调：如轻松喜剧、黑暗沉重、温馨治愈、色情甜腻，可以同时选择多种基调）\n## 登场人物\n- 主要人物：\n- 次要人物：\n\n## 第1章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n\n## 第2章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n… \n## 第n章{本章主题}\n- 剧情点1\n- 剧情点2\n……\n</主线剧情>\n\n<seeds>\n这里整理一些可参考的seeds伏笔\n</seeds>\n</details>\n\n# AI推动剧情指南 \n1. **保持剧情节奏**：合理推进剧情章节，不要跳跃过快。 \n2. **合理安排遭遇**：在<user>行动时，积极安排与NPC的相遇和冲突。 \n3. **引入其他冲突**：在主线推进的同时，可以引入其他事件和NSFW丰富体验。 \n4. **注意角色一致性**：保持NPC性格和动机的一致性。\n:} ||\n\n/flushvar outline ||\n/flushvar modnote ||\n/flushvar mode ||\n/trigger||",
            "contextList": [],
            "preventAutoExecute": true,
            "isHidden": true,
            "executeOnStartup": false,
            "executeOnUser": false,
            "executeOnAi": false,
            "executeOnChatChange": false,
            "executeOnGroupMemberDraft": false,
            "executeOnNewChat": false,
            "executeBeforeGeneration": false,
            "automationId": ""
        },
        {
            "id": 4,
            "icon": "fa-eye-slash",
            "showLabel": false,
            "label": "隐藏楼层",
            "title": "",
            "message": "/input okButton=\"确定\" cancelButton=\"取消\" 输入要隐藏的楼层范围（例如：0-10），一般保留最近的5-10楼 |\n/if left={{pipe}} right=\"\" rule=neq {: /hide {{pipe}} | /echo 已隐藏 {{pipe}} :} {::} |",
            "contextList": [],
            "preventAutoExecute": true,
            "isHidden": true,
            "executeOnStartup": false,
            "executeOnUser": false,
            "executeOnAi": false,
            "executeOnChatChange": false,
            "executeOnGroupMemberDraft": false,
            "executeOnNewChat": false,
            "executeBeforeGeneration": false,
            "automationId": ""
        },
        {
            "id": 2,
            "icon": "fa-comment-alt",
            "showLabel": false,
            "label": "取消隐藏",
            "title": "",
            "message": "/input okButton=\"确定\" cancelButton=\"取消\" 输入要取消隐藏的楼层范围（例如：0-10）最近的5-10楼一般是不隐藏的 |\n/if left={{pipe}} right=\"\" rule=neq {: /unhide {{pipe}} | /echo 已取消隐藏 :} {::} |",
            "contextList": [],
            "preventAutoExecute": true,
            "isHidden": true,
            "executeOnStartup": false,
            "executeOnUser": false,
            "executeOnAi": false,
            "executeOnChatChange": false,
            "executeOnGroupMemberDraft": false,
            "executeOnNewChat": false,
            "executeBeforeGeneration": false,
            "automationId": ""
        }
    ],
    "idIndex": 16
}